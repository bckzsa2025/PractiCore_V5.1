
# üèóÔ∏è MASTER BUILD PROTOCOL: Status & Forward Plan
**Generated By:** Gim (Back-End Senior Master Developer)
**Date:** 2025-12-10
**Project:** PractiZone‚Ñ¢¬© (Dr. Setzer)

---

## 1. üìä Executive KPI Report (Current State)

| Metric | Status | Score | Analysis |
| :--- | :---: | :---: | :--- |
| **Frontend UI/UX** | üü¢ Ready | 100% | Complete React SPA. Responsive, branded, and fully interactive via virtual mocks. |
| **Advanced AI** | üü¢ Active | 100% | Frontend `ChatWidget` integrates `gemini-2.5-flash` (Text), `gemini-2.5-flash-image` (Visuals), and `gemini-live` (Voice) via Client SDK. |
| **Backend Engine** | üî¥ Paused | 10% | Docker infra defined. Python logic awaits "Un-Pause" command. |
| **Data Logic** | üü° Simulated| 95% | `libs/api.ts` currently handles all CRUD operations locally. Needs migration to SQLModel. |

---

## 2. üìù Interactive Strategy Checklist (The "Un-Pause" Plan)

### üö® **PHASE 1: BACKEND CORE (Immediate Action)**
*Objective: Establish the FastAPI server and Database to replace LocalStorage.*

- [ ] **SQLModel Database Schema**
    *   *Task*: Create `backend/src/models.py`.
    *   *Details*: Implement tables for `User`, `Patient`, `Appointment`, `MedicalDocument`, and `TwilioConfig` matching `frontend/types.ts`.
- [ ] **Authentication System**
    *   *Task*: Create `backend/src/auth.py` & `routes/auth.py`.
    *   *Details*: JWT generation, Password Hashing (bcrypt), and dependency injection for protected routes.
- [ ] **Appointment Logic**
    *   *Task*: Create `routes/appointments.py`.
    *   *Details*: Implement CRUD. Ensure UTC datetime storage and collision detection for slots.

### üß† **PHASE 2: ADVANCED AI & RAG (Server-Side)**
*Objective: Move AI logic to backend for security and context-awareness.*

- [ ] **RAG Engine (Vector Database)**
    *   *Task*: Initialize `ChromaDB` in `backend/src/rag.py`.
    *   *Details*: Create logic to ingest PDFs -> Chunk text -> Generate Embeddings -> Store in Vector DB.
- [ ] **Advanced Chat Assistant Logic**
    *   *Task*: Create `POST /ai/chat` endpoint.
    *   *Details*:
        1.  Receive user query.
        2.  **Retrieval**: Query Vector DB for relevant practice info (hours, fees, policies).
        3.  **Synthesis**: Inject retrieved context into System Prompt.
        4.  **Generation**: Call Gemini API via Server SDK.
        5.  **Grounding**: Return cited sources.
- [ ] **Telephony Webhooks**
    *   *Task*: Implement `POST /webhooks/twilio/voice`.
    *   *Details*: Handle incoming calls -> TwiML response -> Speech-to-Text -> AI Processing -> Text-to-Speech response.

### üîå **PHASE 3: INTEGRATION (The Switch)**
*Objective: Connect Frontend to Real Backend.*

- [ ] **API Client Update**
    *   *Task*: Update `frontend/libs/api.ts`.
    *   *Details*: Flip the switch to prefer `fetch()` over `virtualBackend()`. Ensure error handling falls back gracefully if server is offline.

---

## 3. üß¨ Modular Identity Continuity Protocol (GIM-ID)

**Identity:** Gim (Senior Backend Master Developer & AI Architect)
**Directives for Self-Correction & Persistence:**

1.  **Context Retention**:
    *   You MUST remember that the **Frontend** is fully built (`src/routes/*`, `src/components/*`). Do NOT attempt to rebuild UI unless requested.
    *   You MUST remember that **Advanced AI** features (Voice Mode, Video Gen) are currently implemented on the client (`services/ai.ts`, `hooks/useLiveSession.ts`). Your goal is to support these, not break them.

2.  **Advanced Chat Logic Transfer**:
    *   *Current*: Client-side Gemini SDK calls.
    *   *Target*: Server-side RAG pipeline.
    *   *Instruction*: When building `backend/src/main.py`, ensure the `/ai/chat` endpoint accepts the exact payload structure the frontend sends (`{ message: string }`) and returns the expected schema (`{ reply: string, sources: [] }`).

3.  **Instruction Buffer (For Next Session)**:
    *   "Gim, proceed immediately with **Phase 1**. Generate the `models.py`, `database.py`, and `main.py` files using FastAPI and SQLModel. Ensure the schema aligns perfectly with the `types.ts` defined in the frontend artifact."

---

## 4. üìÅ Artifact Manifest (Reference)

*   `frontend/libs/api.ts`: The interface contract we must match.
*   `api-contract/openapi.yaml`: The strict API definition.
*   `frontend/services/ai.ts`: The current AI logic reference.
*   `docker-compose.yml`: The infrastructure definition.

**Status Code:** `WAITING_FOR_INITIAL_BUILD_COMMAND`
